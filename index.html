<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syntactic Strength: Nattysplitter</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Phosphor Icons -->
    <script src="https://unpkg.com/phosphor-icons"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <style>
        .glow-border {
            box-shadow: 0 0 10px rgba(220, 38, 38, 0.4), 0 0 20px rgba(220, 38, 38, 0.1);
            transition: all 0.3s ease;
        }
        .glow-border:hover {
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.7), 0 0 30px rgba(220, 38, 38, 0.3);
            transform: translateY(-2px);
        }
        .social-login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 12px 16px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .social-login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .google-btn {
            background: white;
            color: #333;
        }
        .facebook-btn {
            background: #1877F2;
            color: white;
        }
        .github-btn {
            background: #333;
            color: white;
        }
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(17, 24, 39, 0.95);
            z-index: 50;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .motivation-card {
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1.5rem;
            background-color: #1F2937;
            border-radius: 0.5rem;
            border: 2px solid #DC2626;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
        }
        .message-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 font-sans min-h-screen flex flex-col">

    <!-- Header / Navigation Bar -->
    <header class="p-4 md:p-6 bg-gray-800 sticky top-0 z-10 border-b border-gray-700/50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <!-- Logo and Title Section -->
            <div class="flex items-center space-x-4">
                <div class="flex flex-col">
                    <h1 class="text-2xl font-extrabold text-red-600">SYNTACTIC STRENGTH</h1>
                    <p class="text-xs text-gray-400 uppercase tracking-wider">Natty Splitter</p>
                </div>
            </div>
            <nav class="hidden md:flex space-x-6 text-sm font-semibold">
                <a href="#wod" class="hover:text-red-500 transition duration-200">WOD</a>
                <a href="#countdown" class="hover:text-red-500 transition duration-200">Start Time</a>
                <a href="#nutrition" class="hover:text-green-500 transition duration-200">Nutrition</a>
                <button id="header-auth-btn" class="bg-red-600 text-white px-4 py-1 rounded-full font-bold hover:bg-red-500 transition duration-300 shadow-lg">REGISTER</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow p-4 md:p-8">
        <div class="max-w-7xl mx-auto">

            <!-- Hero Section -->
            <section class="text-center py-12 md:py-24">
                <h2 class="text-5xl md:text-7xl font-black uppercase tracking-tight text-white mb-4 leading-tight">
                    <span class="text-red-600">Natty</span>splitter
                </h2>
                <p class="text-lg md:text-xl text-gray-400 max-w-3xl mx-auto">
                    The ultimate trial of skill, precision, and digital endurance. Are you ready to train for victory?
                </p>
            </section>

            <!-- Workout Section -->
            <section id="wod" class="mb-16 p-6 md:p-10 bg-gray-800 rounded-xl glow-border">
                <h3 class="text-center text-3xl font-bold text-red-600 mb-6 uppercase tracking-widest">
                    Workout of the Day
                </h3>
                
                <div class="max-w-4xl mx-auto">
                    <!-- User Welcome Message -->
                    <div id="user-welcome-message" class="text-center mb-8">
                        <p id="user-welcome" class="text-xl mb-4">Sign in to track your workouts and join the community!</p>
                        <button id="demo-auth-btn" class="bg-red-500 text-white px-6 py-3 rounded-lg font-bold hover:bg-red-400 transition">
                            Sign In to Continue
                        </button>
                    </div>

                    <!-- Workout Display -->
                    <div class="grid md:grid-cols-5 gap-6 p-6 bg-gray-900 rounded-xl border border-red-500/50">
                        <div class="md:col-span-3">
                            <p id="exercise-equipment" class="text-base font-semibold text-red-300 mb-2 uppercase">
                                BODYWEIGHT
                            </p>
                            <h4 id="exercise-name" class="text-3xl md:text-4xl font-extrabold text-red-600 mb-3">
                                Pushups Challenge
                            </h4>
                            <p id="exercise-details" class="text-lg text-gray-300 whitespace-pre-line mb-4">
                                Perform 3 sets to failure. Maintain a straight line from head to heels. 
                                Modify on knees if needed. (Rest 60 seconds per set)
                            </p>
                            
                            <!-- Timer Controls -->
                            <div class="space-y-3 mt-4">
                                <button id="start-workout-btn" class="w-full bg-red-600 text-white px-6 py-3 rounded-lg font-black uppercase hover:bg-red-500 transition">
                                    START WORKOUT
                                </button>
                            </div>
                        </div>
                        
                        <div class="md:col-span-2 space-y-4">
                            <!-- Motivation Card -->
                            <div class="motivation-card">
                                <p class="text-xl font-bold text-red-300" id="motivation-text">
                                    "Sign in to unlock your full potential!"
                                </p>
                            </div>

                            <!-- User Stats -->
                            <div id="user-stats" class="bg-gray-800 p-4 rounded-lg border border-gray-600 hidden">
                                <h5 class="font-bold text-white mb-2">Your Stats</h5>
                                <p>Workouts Completed: <span id="workout-count">0</span></p>
                                <p>Member Since: <span id="join-date">Today</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Public Workout Log -->
            <section id="history" class="mb-16 p-6 md:p-10 bg-gray-800 rounded-xl border border-blue-500/50">
                <h3 class="text-center text-3xl font-bold text-blue-500 mb-6 uppercase tracking-widest">
                    Public Workout Log
                </h3>
                <div class="text-center">
                    <p class="text-lg mb-4">See what others are achieving in real-time!</p>
                    <div id="public-workouts" class="bg-gray-900 p-6 rounded-lg">
                        <div class="text-center text-gray-400">
                            <i class="ph ph-users ph-2x mb-2"></i>
                            <p>Community workouts will appear here when users start training</p>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- Footer -->
    <footer class="p-6 bg-gray-800 border-t border-gray-700/50 text-center">
        <p class="text-lg font-semibold mb-3">Ready to Max Out Your Skills?</p>
        <button id="footer-auth-btn" class="bg-red-600 text-white text-xl px-8 py-3 rounded-full font-black uppercase hover:bg-red-500 transition duration-300 shadow-xl">
            Secure Your Spot (Register Now)
        </button>
        <p class="text-sm text-gray-500 mt-4">&copy; 2025 Nattysplitter. Power by Synaptic Performance.</p>
    </footer>

    <!-- Sign-In/Registration Modal -->
    <div id="auth-modal" class="modal-backdrop">
        <div class="bg-gray-800 p-8 md:p-10 rounded-xl border border-red-500/50 max-w-lg w-11/12 mx-auto relative">
            <!-- Close Button -->
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 transition">
                <i class="ph-bold ph-x text-2xl"></i>
            </button>

            <h2 class="text-4xl font-extrabold text-red-600 mb-3 text-center">ACCESS TERMINAL</h2>
            <p class="text-center text-gray-400 mb-8">Sign in or create your Syntactic Strength profile.</p>

            <!-- Social Login Buttons -->
            <div class="space-y-4 mb-6">
                <button id="google-login-btn" class="social-login-btn google-btn">
                    <i class="ph ph-google-logo"></i>
                    Continue with Google
                </button>
                <button id="email-login-btn" class="social-login-btn" style="background: #DC2626; color: white;">
                    <i class="ph ph-envelope-simple"></i>
                    Continue with Email
                </button>
            </div>

            <!-- Separator -->
            <div class="flex items-center my-6">
                <div class="flex-grow border-t border-gray-700"></div>
                <span class="flex-shrink mx-4 text-gray-500 text-sm">OR USE EMAIL & PASSWORD</span>
                <div class="flex-grow border-t border-gray-700"></div>
            </div>

            <!-- Email/Password Form -->
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-400 mb-1">Email</label>
                    <input type="email" id="email" required class="w-full p-3 rounded-lg bg-gray-900 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500 transition" placeholder="Enter your email">
                </div>
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-400 mb-1">Password</label>
                    <input type="password" id="password" required class="w-full p-3 rounded-lg bg-gray-900 border border-gray-600 text-white focus:ring-red-500 focus:border-red-500 transition" placeholder="Enter your password">
                </div>
                
                <button type="submit" class="w-full bg-red-600 text-white p-3 rounded-lg font-black uppercase hover:bg-red-500 transition shadow-lg mt-4">
                    LOGIN / CREATE ACCOUNT
                </button>

                <p class="text-center text-sm text-gray-500 pt-2">
                    By signing in, you agree to our Terms of Service
                </p>
            </form>

        </div>
    </div>

    <script>
        // === FIREBASE CONFIGURATION ===
        const firebaseConfig = {
            apiKey: "AIzaSyAzf3ySF47i0n_T7kiyscgnslOMaJxajzE",
            authDomain: "nattysplitter-5de8e.firebaseapp.com",
            projectId: "nattysplitter-5de8e",
            storageBucket: "nattysplitter-5de8e.firebasestorage.app",
            messagingSenderId: "852931698553",
            appId: "1:852931698553:web:6aa6e4a5324964db0ed9a8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // === GLOBAL VARIABLES ===
        let currentUser = null;
        let userWorkouts = [];

        // === DOM ELEMENTS ===
        const authModal = document.getElementById('auth-modal');
        const headerAuthBtn = document.getElementById('header-auth-btn');
        const footerAuthBtn = document.getElementById('footer-auth-btn');
        const demoAuthBtn = document.getElementById('demo-auth-btn');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const userWelcome = document.getElementById('user-welcome');
        const userWelcomeMessage = document.getElementById('user-welcome-message');
        const motivationText = document.getElementById('motivation-text');
        const userStats = document.getElementById('user-stats');
        const startWorkoutBtn = document.getElementById('start-workout-btn');
        const publicWorkouts = document.getElementById('public-workouts');

        // Social login buttons
        const googleLoginBtn = document.getElementById('google-login-btn');
        const emailLoginBtn = document.getElementById('email-login-btn');
        const loginForm = document.getElementById('login-form');

        // Motivational quotes
        const motivationalQuotes = [
            "You got this! Nothing is impossible.",
            "Your next rep starts now. Focus.",
            "The only bad workout is the one that didn't happen.",
            "Push past the pain. Achieve greatness.",
            "Strength doesn't come from what you can do. It comes from overcoming the things you once thought you couldn't.",
            "Don't stop when you're tired. Stop when you're done.",
            "The body achieves what the mind believes.",
            "Success starts with self-discipline.",
            "Train like a beast, look like a beauty.",
            "Your only limit is you."
        ];

        // === AUTHENTICATION FUNCTIONS ===

        // Initialize auth state listener
        const initAuth = () => {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    // User is signed in
                    currentUser = user;
                    console.log('User signed in:', user.email);
                    updateUI();
                    closeAuthModal();
                    showMessage(`Welcome back, ${user.displayName || user.email.split('@')[0]}!`, 'success');
                    
                    // Load user data
                    loadUserData();
                    
                } else {
                    // User is signed out
                    currentUser = null;
                    console.log('User signed out');
                    updateUI();
                }
            });
        };

        // Google Sign In
        const signInWithGoogle = () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then((result) => {
                    console.log('Google sign in successful');
                })
                .catch((error) => {
                    console.error('Google sign in error:', error);
                    showMessage('Please add "gym09.github.io" to authorized domains in Firebase Console', 'error');
                });
        };

        // Email/Password Sign Up
        const signUpWithEmail = (email, password) => {
            auth.createUserWithEmailAndPassword(email, password)
                .then((result) => {
                    console.log('Email sign up successful');
                    showMessage('Account created successfully! Welcome to Nattysplitter! ðŸŽ‰', 'success');
                })
                .catch((error) => {
                    console.error('Email sign up error:', error);
                    showMessage('Failed to create account: ' + error.message, 'error');
                });
        };

        // Email/Password Sign In
        const signInWithEmail = (email, password) => {
            auth.signInWithEmailAndPassword(email, password)
                .then((result) => {
                    console.log('Email sign in successful');
                })
                .catch((error) => {
                    console.error('Email sign in error:', error);
                    // If sign in fails, try to create account
                    if (error.code === 'auth/user-not-found') {
                        signUpWithEmail(email, password);
                    } else {
                        showMessage('Failed to sign in: ' + error.message, 'error');
                    }
                });
        };

        // Sign Out
        const signOut = () => {
            auth.signOut()
                .then(() => {
                    console.log('User signed out successfully');
                    showMessage('Signed out successfully', 'info');
                })
                .catch((error) => {
                    console.error('Sign out error:', error);
                    showMessage('Error signing out: ' + error.message, 'error');
                });
        };

        // === UI FUNCTIONS ===

        // Update UI based on auth state
        const updateUI = () => {
            if (currentUser) {
                const displayName = currentUser.displayName || currentUser.email;
                const firstName = displayName.split(' ')[0];
                const welcomeText = `Welcome, ${firstName}! Ready to crush your workout?`;
                
                // Update header button
                headerAuthBtn.textContent = firstName;
                headerAuthBtn.classList.remove('bg-red-600');
                headerAuthBtn.classList.add('bg-white', 'text-gray-900');
                
                // Update footer button
                footerAuthBtn.textContent = 'My Account';
                footerAuthBtn.classList.remove('bg-red-600');
                footerAuthBtn.classList.add('bg-white', 'text-gray-900');
                
                // Update welcome message
                userWelcome.textContent = welcomeText;
                userWelcomeMessage.innerHTML = `
                    <p class="text-xl mb-2">Welcome, <strong>${displayName}</strong>!</p>
                    <p class="text-green-400 mb-4">âœ“ You're signed in and ready to train</p>
                `;
                
                // Update demo button to sign out
                demoAuthBtn.textContent = 'Sign Out';
                demoAuthBtn.onclick = signOut;
                demoAuthBtn.classList.remove('bg-red-500', 'hover:bg-red-400');
                demoAuthBtn.classList.add('bg-gray-600', 'hover:bg-gray-500');
                
                // Update motivation text
                const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
                motivationText.textContent = `"${randomQuote}"`;
                
                // Show user stats
                userStats.classList.remove('hidden');
                
                // Update workout button
                startWorkoutBtn.textContent = 'START WORKOUT';
                startWorkoutBtn.onclick = startWorkout;
                
            } else {
                // User is signed out
                headerAuthBtn.textContent = 'REGISTER';
                headerAuthBtn.classList.add('bg-red-600');
                headerAuthBtn.classList.remove('bg-white', 'text-gray-900');
                
                footerAuthBtn.textContent = 'Secure Your Spot (Register Now)';
                footerAuthBtn.classList.add('bg-red-600');
                footerAuthBtn.classList.remove('bg-white', 'text-gray-900');
                
                userWelcome.textContent = 'Sign in to track your workouts and join the community!';
                userWelcomeMessage.innerHTML = `
                    <p class="text-xl mb-4">Sign in to track your workouts and join the community!</p>
                `;
                
                demoAuthBtn.textContent = 'Sign In to Continue';
                demoAuthBtn.onclick = openAuthModal;
                demoAuthBtn.classList.remove('bg-gray-600', 'hover:bg-gray-500');
                demoAuthBtn.classList.add('bg-red-500', 'hover:bg-red-400');
                
                motivationText.textContent = '"Sign in to unlock your full potential!"';
                
                // Hide user stats
                userStats.classList.add('hidden');
                
                // Update workout button
                startWorkoutBtn.textContent = 'SIGN IN TO START WORKOUT';
                startWorkoutBtn.onclick = openAuthModal;
            }
        };

        // Load user data
        const loadUserData = () => {
            // For demo purposes - in real app, you'd load from Firestore
            document.getElementById('workout-count').textContent = userWorkouts.length;
            document.getElementById('join-date').textContent = new Date().toLocaleDateString();
        };

        // Start workout function
        const startWorkout = () => {
            if (!currentUser) {
                openAuthModal();
                return;
            }
            
            // Add workout to history
            const workout = {
                exercise: 'Pushups Challenge',
                date: new Date().toLocaleString(),
                user: currentUser.displayName || currentUser.email
            };
            
            userWorkouts.push(workout);
            updatePublicWorkouts(workout);
            loadUserData();
            
            showMessage('Workout started! ðŸ’ª Keep pushing!', 'success');
        };

        // Update public workouts display
        const updatePublicWorkouts = (workout) => {
            const workoutEl = document.createElement('div');
            workoutEl.className = 'bg-gray-800 p-3 rounded-lg mb-2 border border-gray-600';
            workoutEl.innerHTML = `
                <div class="flex justify-between items-center">
                    <span class="font-semibold">${workout.exercise}</span>
                    <span class="text-sm text-gray-400">${workout.date}</span>
                </div>
                <div class="text-sm text-gray-300">Completed by: ${workout.user}</div>
            `;
            
            // If it's the first workout, clear the placeholder
            if (publicWorkouts.querySelector('.text-center')) {
                publicWorkouts.innerHTML = '';
            }
            
            publicWorkouts.prepend(workoutEl);
        };

        // Modal functions
        const openAuthModal = () => {
            authModal.style.display = 'flex';
            // Clear form
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
        };

        const closeAuthModal = () => {
            authModal.style.display = 'none';
        };

        // Show message to user
        const showMessage = (message, type = 'info') => {
            // Remove existing messages
            document.querySelectorAll('.message-toast').forEach(el => el.remove());
            
            // Create message element
            const messageEl = document.createElement('div');
            const bgColor = type === 'error' ? 'bg-red-500' : 
                           type === 'success' ? 'bg-green-500' : 'bg-blue-500';
            
            messageEl.className = `message-toast ${bgColor}`;
            messageEl.textContent = message;
            
            document.body.appendChild(messageEl);
            
            // Remove message after 5 seconds
            setTimeout(() => {
                messageEl.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    if (messageEl.parentNode) {
                        document.body.removeChild(messageEl);
                    }
                }, 300);
            }, 5000);
        };

        // === EVENT LISTENERS ===
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize auth
            initAuth();
            
            // Modal controls
            headerAuthBtn.addEventListener('click', openAuthModal);
            footerAuthBtn.addEventListener('click', openAuthModal);
            demoAuthBtn.addEventListener('click', openAuthModal);
            closeModalBtn.addEventListener('click', closeAuthModal);
            
            // Close modal when clicking outside
            authModal.addEventListener('click', (e) => {
                if (e.target === authModal) {
                    closeAuthModal();
                }
            });

            // Social login buttons
            googleLoginBtn.addEventListener('click', signInWithGoogle);
            emailLoginBtn.addEventListener('click', () => {
                document.getElementById('email').focus();
            });

            // Email/password form
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (!email || !password) {
                    showMessage('Please enter both email and password', 'error');
                    return;
                }
                
                if (password.length < 6) {
                    showMessage('Password should be at least 6 characters', 'error');
                    return;
                }
                
                // Try to sign in first, if fails then create account
                signInWithEmail(email, password);
            });

            // Close modal with Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeAuthModal();
                }
            });

            // Demo workout button
            startWorkoutBtn.addEventListener('click', () => {
                if (!currentUser) {
                    openAuthModal();
                } else {
                    startWorkout();
                }
            });
        });
    </script>
</body>
</html>
